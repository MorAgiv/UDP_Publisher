The publisher does two things: accepts subscriptions and publishes shapes.
Accepting subscribers- it has a specific port for listening to subscribing subscribers.
On that port they tell it which shapes they want to recieve and on which port they want to recieve them.
The publisher saves the information and then publishes squares and circles to the relevant ports at the relevant frequency.
